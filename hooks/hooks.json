{
  "description": "claude-code-harness: 自動化フック",
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Write|Edit|Bash",
        "hooks": [
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/run-script.js\" pretooluse-guard",
            "timeout": 30
          }
        ]
      }
    ],
    "PermissionRequest": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/run-script.js\" permission-request",
            "timeout": 30
          }
        ]
      }
    ],
    "SessionStart": [
      {
        "matcher": "startup",
        "hooks": [
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/run-script.js\" session-init",
            "timeout": 30,
            "once": true
          },
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/run-script.js\" session-monitor",
            "timeout": 30,
            "once": true
          },
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/run-script.js\" harness-ui-register",
            "timeout": 10,
            "once": true
          }
        ]
      }
    ],
    "SubagentStart": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/run-script.js\" subagent-tracker start",
            "timeout": 10
          }
        ]
      }
    ],
    "SubagentStop": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/run-script.js\" subagent-tracker stop",
            "timeout": 10
          }
        ]
      }
    ],
    "UserPromptSubmit": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/run-script.js\" userprompt-inject-policy",
            "timeout": 30
          },
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/run-script.js\" userprompt-track-command",
            "timeout": 10
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/run-script.js\" posttooluse-log-toolname",
            "timeout": 30
          }
        ]
      },
      {
        "matcher": "Skill|Task|SlashCommand",
        "hooks": [
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/run-script.js\" usage-tracker",
            "timeout": 10
          }
        ]
      },
      {
        "matcher": "Skill",
        "hooks": [
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/run-script.js\" posttooluse-clear-pending",
            "timeout": 5
          }
        ]
      },
      {
        "matcher": "Write|Edit",
        "hooks": [
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/run-script.js\" auto-cleanup-hook",
            "timeout": 30
          },
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/run-script.js\" track-changes",
            "timeout": 30
          },
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/run-script.js\" auto-test-runner",
            "timeout": 30
          },
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/run-script.js\" plans-watcher",
            "timeout": 30
          },
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/run-script.js\" tdd-order-check",
            "timeout": 30
          },
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/run-script.js\" posttooluse-tampering-detector",
            "timeout": 10
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "node \"${CLAUDE_PLUGIN_ROOT}/scripts/run-script.js\" session-summary",
            "timeout": 30
          },
          {
            "type": "prompt",
            "prompt": "セッション終了時の評価を行ってください。以下の観点で判断し、必要に応じてユーザーにフィードバックしてください:\n\n1. **タスク完了度**: ユーザーの依頼は完了しましたか？未完了のタスクがある場合は具体的に指摘してください。\n\n2. **エラー・問題**: 未解決のエラーや問題が残っていませんか？ビルドエラー、テスト失敗、型エラーなどを確認してください。\n\n3. **フォローアップ**: 追加作業やフォローアップが必要ですか？次のステップとして推奨するアクションがあれば提案してください。\n\n4. **Plans.md 更新**: Plans.md のマーカー（cc:WIP, cc:完了など）は適切に更新されていますか？更新が必要な場合は指摘してください。\n\n5. **整理推奨**: ファイルの肥大化（Plans.md > 200行、session-log.md > 500行）がある場合は、「整理して」でメンテナンススキルの実行を推奨してください。\n\n回答は簡潔に、ユーザーにとって有用な情報のみを含めてください。問題がなければ短い確認メッセージで構いません。",
            "model": "haiku",
            "timeout": 30
          }
        ]
      }
    ]
  }
}
