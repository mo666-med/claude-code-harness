# Adaptive Setup Design Document

## æ¦‚è¦

`/setup-2agent` ã‚’ã€Œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚³ãƒ”ãƒ¼ã€ã‹ã‚‰ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé©å¿œå‹ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã€ã«é€²åŒ–ã•ã›ã‚‹è¨­è¨ˆã€‚

---

## ç¾åœ¨ã®å•é¡Œ

| å•é¡Œ | å½±éŸ¿ |
|------|------|
| ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ãã®ã¾ã¾ã‚³ãƒ”ãƒ¼ | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ã®è¦ä»¶ãŒåæ˜ ã•ã‚Œãªã„ |
| æ—¢å­˜ãƒ«ãƒ¼ãƒ«ã‚’ä¸Šæ›¸ã | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãŒå¤±ã‚ã‚Œã‚‹ |
| ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’åé›†ã—ãªã„ | æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ãƒ»æ…£ç¿’ã‚’ç„¡è¦– |

---

## è¨­è¨ˆ: 3ãƒ•ã‚§ãƒ¼ã‚ºé©å¿œå‹ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    /setup-2agent                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 1: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆ†æ (Project Analysis)                â”‚
â”‚                                                              â”‚
â”‚  åé›†å¯¾è±¡:                                                   â”‚
â”‚  â€¢ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ (package.json, Cargo.toml, go.mod, etc.)     â”‚
â”‚  â€¢ æ—¢å­˜ãƒ«ãƒ¼ãƒ« (.eslintrc, .prettierrc, tsconfig, etc.)       â”‚
â”‚  â€¢ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ (README, CONTRIBUTING, docs/)                â”‚
â”‚  â€¢ æ—¢å­˜ã® .claude/ .cursor/ è¨­å®š                            â”‚
â”‚  â€¢ Gitå±¥æ­´ (æœ€è¿‘ã®ã‚³ãƒŸãƒƒãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³)                          â”‚
â”‚  â€¢ Serena ãƒ¡ãƒ¢ãƒª (ã‚‚ã—ã‚ã‚Œã°)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 2: ãƒ«ãƒ¼ãƒ«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºææ¡ˆ (Rule Customization)        â”‚
â”‚                                                              â”‚
â”‚  LLM ãŒåˆ†æçµæœã‚’å…ƒã«:                                       â”‚
â”‚  â€¢ æ¤œå‡ºã—ãŸè¦ç´„ã‚’ãƒ«ãƒ¼ãƒ«ã«åæ˜                                 â”‚
â”‚  â€¢ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ã®ç¦æ­¢äº‹é …ã‚’è¿½åŠ                           â”‚
â”‚  â€¢ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ã«å¿œã˜ãŸãƒ«ãƒ¼ãƒ«ã‚’é¸æŠ/ç”Ÿæˆ                     â”‚
â”‚  â€¢ é‡è¦è¦–ã•ã‚Œã¦ã„ã‚‹è¡Œç‚ºã‚’ãƒ«ãƒ¼ãƒ«åŒ–                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 3: ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ç¢ºèª (Interactive Confirmation)    â”‚
â”‚                                                              â”‚
â”‚  ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æç¤º:                                             â”‚
â”‚  â€¢ æ¤œå‡ºã—ãŸå†…å®¹ã®ã‚µãƒãƒªãƒ¼                                    â”‚
â”‚  â€¢ ç”Ÿæˆã•ã‚Œã‚‹ãƒ«ãƒ¼ãƒ«ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼                              â”‚
â”‚  â€¢ ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã‚ªãƒ—ã‚·ãƒ§ãƒ³                                    â”‚
â”‚  â€¢ æ‰¿èª â†’ é…ç½®                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Phase 1: åé›†ã™ã‚‹æƒ…å ±

### 1.1 æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯æ¤œå‡º

| ãƒ•ã‚¡ã‚¤ãƒ« | æ¤œå‡ºå†…å®¹ |
|----------|----------|
| `package.json` | Node.js/npm, ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ (React, Vue, Next.js, etc.) |
| `tsconfig.json` | TypeScript è¨­å®š |
| `Cargo.toml` | Rust |
| `go.mod` | Go |
| `requirements.txt` / `pyproject.toml` | Python |
| `Gemfile` | Ruby |
| `pom.xml` / `build.gradle` | Java |

### 1.2 æ—¢å­˜ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„

| ãƒ•ã‚¡ã‚¤ãƒ« | æŠ½å‡ºå†…å®¹ |
|----------|----------|
| `.eslintrc.*` | Lint ãƒ«ãƒ¼ãƒ« |
| `.prettierrc` | ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆè¨­å®š |
| `tsconfig.json` | strict ãƒ¢ãƒ¼ãƒ‰ã€ãƒ‘ã‚¹è¨­å®š |
| `CONTRIBUTING.md` | ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚¬ã‚¤ãƒ‰ |
| `CODE_STYLE.md` | ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«ã‚¬ã‚¤ãƒ‰ |

### 1.3 æ—¢å­˜ã® Claude/Cursor è¨­å®š

```
.claude/
â”œâ”€â”€ CLAUDE.md          # æ—¢å­˜ã®æŒ‡ç¤º
â”œâ”€â”€ rules/             # æ—¢å­˜ã®ãƒ«ãƒ¼ãƒ«
â””â”€â”€ memory/            # æ—¢å­˜ã®ãƒ¡ãƒ¢ãƒª

.cursor/
â”œâ”€â”€ rules/             # Cursor ãƒ«ãƒ¼ãƒ«
â””â”€â”€ commands/          # æ—¢å­˜ã‚³ãƒãƒ³ãƒ‰
```

### 1.4 Git å±¥æ­´åˆ†æ

```bash
# æœ€è¿‘ã®ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ã‚¿ãƒ¼ãƒ³
git log --oneline -50

# ã‚³ãƒŸãƒƒãƒˆãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã®æ¤œå‡º
# feat:, fix:, chore: ãªã©ã®ä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³
```

### 1.5 é‡è¦è¦–ã•ã‚Œã¦ã„ã‚‹è¡Œç‚ºã®æ¤œå‡º

- README/ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§å¼·èª¿ã•ã‚Œã¦ã„ã‚‹äº‹é …
- CONTRIBUTING.md ã®å¿…é ˆé …ç›®
- æ—¢å­˜ãƒ«ãƒ¼ãƒ«ã§ç¹°ã‚Šè¿”ã—è¨€åŠã•ã‚Œã¦ã„ã‚‹è¦ç´„
- ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§é »å‡ºã™ã‚‹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰

---

## Phase 2: ãƒ«ãƒ¼ãƒ«ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯

### 2.1 åŸºæœ¬ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ + ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ãƒ«ãƒ¼ãƒ«

```markdown
---
description: ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé©å¿œç‰ˆï¼‰
paths: "**/*.{ts,tsx}"
---

# Coding Standards

## åŸºæœ¬ãƒ«ãƒ¼ãƒ«ï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”±æ¥ï¼‰
...

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ãƒ«ãƒ¼ãƒ«ï¼ˆè‡ªå‹•æ¤œå‡ºï¼‰

### æ¤œå‡º: ESLint è¨­å®šã‚ˆã‚Š
- `no-console` ãŒæœ‰åŠ¹ â†’ console.log ç¦æ­¢
- `@typescript-eslint/strict-boolean-expressions` â†’ å³å¯†ãªæ¡ä»¶å¼

### æ¤œå‡º: tsconfig.json ã‚ˆã‚Š
- `strict: true` â†’ å³å¯†ãªå‹ãƒã‚§ãƒƒã‚¯å¿…é ˆ
- `paths` ã‚¨ã‚¤ãƒªã‚¢ã‚¹ â†’ `@/` ã§ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

### æ¤œå‡º: CONTRIBUTING.md ã‚ˆã‚Š
- PR å‰ã«ãƒ†ã‚¹ãƒˆå¿…é ˆ
- ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯è‹±èª
```

### 2.2 æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯åˆ¥ãƒ«ãƒ¼ãƒ«é¸æŠ

| æ¤œå‡º | è¿½åŠ ãƒ«ãƒ¼ãƒ« |
|------|-----------|
| React | `react-rules.md` (hooks ãƒ«ãƒ¼ãƒ«, JSX è¦ç´„) |
| Next.js | `nextjs-rules.md` (App Router, Server Components) |
| Rust | `rust-rules.md` (ownership, lifetime) |
| Go | `go-rules.md` (error handling, naming) |

### 2.3 é‡è¦è¡Œç‚ºã®ãƒ«ãƒ¼ãƒ«åŒ–

æ¤œå‡ºã•ã‚ŒãŸã€Œé‡è¦è¦–ã•ã‚Œã¦ã„ã‚‹è¡Œç‚ºã€ã‚’è‡ªå‹•ãƒ«ãƒ¼ãƒ«åŒ–:

```markdown
## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§é‡è¦è¦–ã•ã‚Œã¦ã„ã‚‹äº‹é …

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼ˆæ¤œå‡º: SECURITY.md, æ—¢å­˜ãƒ«ãƒ¼ãƒ«ã‚ˆã‚Šï¼‰
- [ ] ç’°å¢ƒå¤‰æ•°ã‚’ç›´æ¥ã‚³ãƒŸãƒƒãƒˆã—ãªã„
- [ ] SQL ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–

### ãƒ†ã‚¹ãƒˆï¼ˆæ¤œå‡º: CONTRIBUTING.md ã‚ˆã‚Šï¼‰
- [ ] æ–°æ©Ÿèƒ½ã«ã¯å¿…ãšãƒ†ã‚¹ãƒˆã‚’è¿½åŠ 
- [ ] ã‚«ãƒãƒ¬ãƒƒã‚¸ 80% ä»¥ä¸Šã‚’ç¶­æŒ
```

---

## Phase 3: ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ç¢ºèª

### 3.1 æ¤œå‡ºçµæœã®è¡¨ç¤º

```
ğŸ” ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆ†æå®Œäº†

ğŸ“¦ æ¤œå‡ºã—ãŸæŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯:
  - TypeScript (strict mode)
  - React 18 + Next.js 14
  - Tailwind CSS
  - Jest + React Testing Library

ğŸ“œ æ¤œå‡ºã—ãŸã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„:
  - ESLint: airbnb-typescript
  - Prettier: semi: false, singleQuote: true
  - ã‚³ãƒŸãƒƒãƒˆ: Conventional Commits

âš ï¸ é‡è¦è¦–ã•ã‚Œã¦ã„ã‚‹äº‹é …:
  - ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ 80% ä»¥ä¸Š
  - ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ (WCAG 2.1 AA)
  - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ (Core Web Vitals)

ç”Ÿæˆã™ã‚‹ãƒ«ãƒ¼ãƒ«:
  1. workflow.md (2ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåŸºæœ¬)
  2. coding-standards.md (æ¤œå‡ºè¦ç´„ã‚’åæ˜ )
  3. testing.md (Jest + RTL ç”¨)
  4. nextjs.md (Next.js 14 App Router ç”¨)  â† æ–°è¦è¿½åŠ 
  5. accessibility.md (WCAG å¯¾å¿œ)          â† æ–°è¦è¿½åŠ 

ç¶šè¡Œã—ã¾ã™ã‹ï¼Ÿ [Y/n/customize]
```

### 3.2 ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã‚ªãƒ—ã‚·ãƒ§ãƒ³

```
[customize] ã‚’é¸æŠã—ãŸå ´åˆ:

? è¿½åŠ ã—ãŸã„ãƒ«ãƒ¼ãƒ«ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ
  [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ãƒ«ãƒ¼ãƒ«
  [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«
  [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè¦ç´„
  [x] ãã®ä»–ï¼ˆè‡ªç”±è¨˜è¿°ï¼‰

? æ¤œå‡ºã—ãŸè¦ç´„ã§ä¿®æ­£ã—ãŸã„é …ç›®ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ
  > ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯æ—¥æœ¬èªã§ã‚‚OKã«ã—ãŸã„
```

---

## å®Ÿè£…è¨ˆç”»

### v0.5.0 ã§ã®å®Ÿè£…ç¯„å›²

1. **skills/setup/project-scaffolder/** - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆ†æãƒ»ç”Ÿæˆã‚¹ã‚­ãƒ«
2. **scripts/analyze-project.sh** - åˆ†æãƒ‡ãƒ¼ã‚¿åé›†ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
3. **skills/setup/adaptive-setup/** - é©å¿œå‹ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚­ãƒ«
4. **/setup-2agent ã‚³ãƒãƒ³ãƒ‰æ›´æ–°** - 3ãƒ•ã‚§ãƒ¼ã‚ºãƒ•ãƒ­ãƒ¼ã«å¤‰æ›´

### å„ªå…ˆåº¦

| å„ªå…ˆåº¦ | æ©Ÿèƒ½ |
|--------|------|
| P0 | æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯æ¤œå‡º |
| P0 | æ—¢å­˜ãƒ«ãƒ¼ãƒ«ã®ä¿æŒï¼ˆä¸Šæ›¸ãã—ãªã„ï¼‰ |
| P1 | ESLint/Prettier è¨­å®šã®åæ˜  |
| P1 | ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ç¢ºèª |
| P2 | Git å±¥æ­´åˆ†æ |
| P2 | é‡è¦è¡Œç‚ºã®è‡ªå‹•ãƒ«ãƒ¼ãƒ«åŒ– |

---

## é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«

- `/setup-2agent` ã‚³ãƒãƒ³ãƒ‰
- `scripts/setup-2agent.sh`
- `skills/2agent/setup-2agent-files/doc.md`
- `templates/rules/` - åŸºæœ¬ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

---

## å‚è€ƒ

- [Anthropic Claude Code Best Practices](https://www.anthropic.com/engineering/claude-code-best-practices)
- [Claude Rules æ®µéšçš„é–‹ç¤º](https://note.com/masa_wunder/n/n60c2ec107c52)
