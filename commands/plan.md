---
description: 受託開発プラン策定（合意形成〜実装計画）
---

# /plan - 受託開発プラン策定

バイブコーダーが受託開発を受けた際に、クライアントとの合意形成から実装計画までを一気通貫で作成します。

---

## ⚠️ モード別の使い分け

| モード | 推奨コマンド | 説明 |
|--------|-------------|------|
| **ソロモード** | `/plan` (このコマンド) | Claude Code だけで計画→実行→レビュー |
| **2エージェントモード** | `/plan-with-cc` (Cursor側) | Cursor で計画 → Claude Code で実行 |

**2エージェント体制** (`/setup-cursor` 済み) の場合:
- **Cursor** で `/plan-with-cc` を使って計画を立ててください
- そのまま Claude Code で `/plan` を使うこともできますが、Cursor との連携は行われません

---

## 使用するスキル

このコマンドは以下のスキルを活用します：

- `ccp-adaptive-setup` - プロジェクト構造の初期化
- `ccp-vibecoder-guide` - VibeCoder向けガイダンス
- `ccp-core-read-repo-context` - プロジェクト状態の把握

---

## このコマンドの目的

**受託開発における計画フェーズを完全自動化**

クライアントからの要望を、以下の3つの成果物に変換します：

1. **クライアント向け提案書** - 合意形成用のドキュメント
2. **機能優先度マトリクス** - 必須/推奨/オプションの分類
3. **見積もり工数** - 人日ベースの概算

---

## 実行フロー

### Step 1: クライアント要望のヒアリング

ユーザーの入力を確認。入力がない場合は質問：

> 🎯 **クライアントは何を作りたいと言っていますか？**
>
> 例：
> - 「予約管理システム」
> - 「ECサイト」
> - 「社内ポータル」
> - 「マッチングアプリ」
>
> クライアントの言葉そのままで大丈夫です！

**回答を待つ**

### Step 2: 解像度を上げる（最大3問）

> 📋 **もう少し教えてください：**
>
> 1. **誰が使いますか？**（エンドユーザーの属性）
> 2. **似ているサービスはありますか？**（例: Airbnb, メルカリ）
> 3. **予算感はありますか？**（概算で構いません。例: 50万円、100万円）

**回答を待つ**

### Step 3: 技術調査（WebSearch）

**ユーザーには聞かない。Claude Code が調査して提案。**

```
WebSearch で調査:
- "{{プロジェクトタイプ}} tech stack 2025"
- "{{類似サービス}} architecture"
- "{{プロジェクトタイプ}} development cost estimate"
```

### Step 4: 機能リストの抽出

クライアント要望から、具体的な機能リストを抽出します。

**例**: 「予約管理システム」の場合
- ユーザー登録・ログイン
- 予約カレンダー表示
- 予約の作成・編集・キャンセル
- 管理者ダッシュボード
- メール通知
- 決済機能
- レビュー機能

### Step 5: 機能優先度マトリクスの作成

各機能を以下の3つに分類します：

| 優先度 | 説明 | 基準 |
|--------|------|------|
| **必須** | MVP（最小限の製品）に必要 | これがないとサービスが成立しない |
| **推奨** | ユーザー体験を大幅に向上 | あると嬉しいが、なくても動く |
| **オプション** | 将来的に追加検討 | 予算・時間に余裕があれば |

**例**: 予約管理システムの場合

| 機能 | 優先度 | 理由 |
|------|--------|------|
| ユーザー登録・ログイン | 必須 | 予約には認証が必要 |
| 予約カレンダー表示 | 必須 | コア機能 |
| 予約の作成・編集・キャンセル | 必須 | コア機能 |
| 管理者ダッシュボード | 推奨 | 運用効率が大幅に向上 |
| メール通知 | 推奨 | ユーザー体験が向上 |
| 決済機能 | オプション | 後から追加可能 |
| レビュー機能 | オプション | 後から追加可能 |

### Step 6: 見積もり工数の算出

各機能の実装工数を人日で見積もります。

**見積もり基準**（バイブコーダー + Claude Code の場合）:

| 機能タイプ | 工数（人日） |
|-----------|------------|
| 認証（Clerk使用） | 0.5-1 |
| CRUD（1テーブル） | 1-2 |
| 管理画面（基本） | 2-3 |
| 決済（Stripe使用） | 2-3 |
| メール通知 | 1-2 |
| CI/CD構築 | 1 |
| デプロイ設定 | 0.5 |

**例**: 予約管理システム（必須機能のみ）

| 機能 | 工数（人日） |
|------|------------|
| ユーザー登録・ログイン | 1 |
| 予約カレンダー表示 | 3 |
| 予約CRUD | 2 |
| 管理者ダッシュボード | 3 |
| メール通知 | 2 |
| CI/CD + デプロイ | 1.5 |
| **合計** | **12.5人日** |

**概算金額**（1人日 = 5万円の場合）: **62.5万円**

### Step 7: クライアント向け提案書の生成

以下の形式で `proposal.md` を生成：

```markdown
# 提案書: {{プロジェクト名}}

**作成日**: {{日付}}  
**提案者**: {{あなたの名前}}  
**クライアント**: {{クライアント名}}

---

## 1. プロジェクト概要

### 目的
{{クライアントの要望を整理}}

### 対象ユーザー
{{エンドユーザーの属性}}

### 参考サービス
{{類似サービス}}

---

## 2. 提案する機能

### 必須機能（MVP）

| 機能 | 説明 | 工数（人日） |
|------|------|------------|
| {{機能1}} | {{説明}} | {{工数}} |
| {{機能2}} | {{説明}} | {{工数}} |

**小計**: {{必須機能の合計工数}}人日

### 推奨機能

| 機能 | 説明 | 工数（人日） |
|------|------|------------|
| {{機能3}} | {{説明}} | {{工数}} |
| {{機能4}} | {{説明}} | {{工数}} |

**小計**: {{推奨機能の合計工数}}人日

### オプション機能（将来追加検討）

- {{機能5}}
- {{機能6}}

---

## 3. 技術スタック

| 項目 | 技術 | 理由 |
|------|------|------|
| フロントエンド | Next.js 15 + TypeScript | モダンで保守性が高い |
| UI | Tailwind CSS + shadcn/ui | 迅速な開発が可能 |
| バックエンド | Supabase | 認証・DB・Storageを統合 |
| 認証 | Clerk | 簡単に実装可能 |
| デプロイ | Vercel | Next.jsとの相性が良い |

---

## 4. 見積もり

### 必須機能のみ（MVP）

- **工数**: {{必須機能の合計工数}}人日
- **金額**: {{概算金額}}円（1人日 = 5万円）
- **納期**: {{納期}}

### 必須 + 推奨機能

- **工数**: {{必須+推奨の合計工数}}人日
- **金額**: {{概算金額}}円（1人日 = 5万円）
- **納期**: {{納期}}

---

## 5. スケジュール

| フェーズ | 期間 | 内容 |
|---------|------|------|
| フェーズ1: 基盤構築 | {{期間}} | プロジェクト初期化、認証、DB設計 |
| フェーズ2: コア機能 | {{期間}} | {{必須機能の実装}} |
| フェーズ3: 仕上げ | {{期間}} | テスト、デプロイ、ドキュメント |

---

## 6. 納品物

- ソースコード（GitHubリポジトリ）
- デプロイ済みアプリケーション（本番環境）
- 管理者マニュアル
- ユーザーマニュアル

---

## 7. 保守・運用

- **保守契約**: 月額{{金額}}円（オプション）
- **内容**: バグ修正、機能追加、サーバー監視

---

**ご検討のほど、よろしくお願いいたします。**
```

### Step 8: Plans.md の生成（開発者用）

提案書とは別に、実装用の `Plans.md` を生成：

```markdown
## 🎯 プロジェクト: {{プロジェクト名}}

### 概要
- **目的**: {{クライアントの要望}}
- **対象**: {{エンドユーザー}}
- **参考**: {{類似サービス}}
- **予算**: {{予算}}
- **納期**: {{納期}}

### 技術スタック
- フロントエンド: {{技術}}
- バックエンド: {{技術}}
- データベース: {{技術}}
- デプロイ: {{技術}}

---

## 🔴 フェーズ1: 基盤構築 `cc:TODO`

- [ ] プロジェクト初期化（`npx create-next-app@latest`）
- [ ] Tailwind CSS + shadcn/ui のセットアップ
- [ ] Supabase プロジェクト作成
- [ ] 環境変数の設定
- [ ] Git初期化 & 初回コミット
- [ ] CI/CD構築（`/ci-setup`）

## 🟡 フェーズ2: コア機能（必須） `cc:TODO`

- [ ] 認証機能（`/auth clerk`）
- [ ] {{機能1}}（`/crud {{テーブル名}}`）
- [ ] {{機能2}}
- [ ] {{機能3}}

## 🟢 フェーズ3: 仕上げ `cc:TODO`

- [ ] レビュー（`/harness-review`）
- [ ] 自動修正（`/auto-fix`）
- [ ] Analytics設定（`/analytics`）
- [ ] デプロイ設定（`/deploy-setup vercel`）
- [ ] ドキュメント作成
```

### Step 9: 次のアクションを案内

> ✅ **提案書と計画が完成しました！**
>
> 📄 **生成したファイル**:
> - `proposal.md` - クライアント向け提案書
> - `Plans.md` - 開発者用実装計画
>
> **次にやること：**
> 1. `proposal.md` をクライアントに送付して、承認をもらう
> 2. 承認後、「フェーズ1を始めて」と言ってください
>
> 💡 **ヒント**: 提案書の内容を調整したい場合は、「{{機能名}}を追加して」と言ってください。

---

## 出力例

ユーザー: 「クライアントが予約管理システムを作りたいと言っています」

→ 生成される成果物:

1. **proposal.md** - クライアント向け提案書（見積もり、スケジュール含む）
2. **Plans.md** - 開発者用実装計画
3. **priority_matrix.md** - 機能優先度マトリクス

---

## 注意事項

- **クライアント視点で書く**: 専門用語を避け、ビジネス価値を強調
- **見積もりは概算**: 詳細な要件定義後に調整可能と明記
- **優先度は柔軟に**: クライアントの予算・納期に応じて調整
- **技術選択は提案**: 最終決定はクライアントと相談
- **保守契約を提案**: 継続的な収益源を確保
