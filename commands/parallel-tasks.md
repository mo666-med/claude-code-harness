---
description: "[オプション] 複数タスクの並列実行と統合レポート生成"
---

# /parallel-tasks - 並列タスク実行

Cursor（PM）から受け取った複数タスクを並列実行し、統合レポートを生成します。

## バイブコーダー向け（こう言えばOK）

- 「**AとBとCを同時に片付けて**」→ このコマンド
- 「**lint/test/typecheckをまとめて回して**」→ 並列実行して結果を1つにまとめます
- 「**並列にして大丈夫？**」→ 依存関係を見て、安全な分割にしてから実行します

## できること（成果物）

- 独立タスクを分割して並列実行し、結果/差分/次アクションを統合レポート化

---

## 概要

このコマンドは複数の独立したタスクを同時に処理し、効率的に作業を完了します。

**使用例**:
```
/parallel-tasks ヘッダー、フッター、サイドバーを作成
/parallel-tasks lint, test, type-check を実行
```

---

## 実行フロー

### Step 1: タスクの分析

入力されたタスクを解析し、並列化可能かを判断します。

**並列化可能な条件**:
1. ファイル依存なし（同じファイルを編集しない）
2. データ依存なし（出力が他の入力にならない）
3. 順序依存なし（実行順序が結果に影響しない）

**判定ロジック**:
```
入力: "A, B, C を作成"

分析結果:
- A: src/components/A.tsx → 独立
- B: src/components/B.tsx → 独立
- C: src/components/C.tsx → 独立
→ 並列実行可能 ✅
```

```
入力: "APIクライアント作成、それを使うページ作成"

分析結果:
- APIクライアント: src/lib/api.ts
- ページ: src/pages/index.tsx (api.ts に依存)
→ 直列実行 ⚠️
```

### Step 2: 実行計画の提示

ユーザーに実行計画を提示して承認を得ます。

> 📋 **並列実行計画**
>
> **並列実行グループ**:
> | タスク | 対象ファイル | 推定時間 |
> |-------|-------------|---------|
> | A作成 | src/components/A.tsx | ~30秒 |
> | B作成 | src/components/B.tsx | ~30秒 |
> | C作成 | src/components/C.tsx | ~30秒 |
>
> **合計推定時間**: 直列 1分30秒 → 並列 30秒
>
> **実行しますか？** (y/n)

### Step 3: Task ツールで並列実行

Claude Code の Task ツールを使用して並列実行します。

```
実行中の表示:

🚀 並列実行開始...

├── [Task 1] A作成中... ⏳
├── [Task 2] B作成中... ⏳
└── [Task 3] C作成中... ⏳
```

**重要**: Task ツールは `run_in_background: true` で起動し、`TaskOutput` で結果を収集します。

### Step 4: 結果の収集と統合

各タスクの結果を収集し、統合レポートを生成します。

```
📊 並列実行完了

├── [Task 1] A作成 ✅ (25秒)
│   └── src/components/A.tsx 作成
├── [Task 2] B作成 ✅ (28秒)
│   └── src/components/B.tsx 作成
└── [Task 3] C作成 ✅ (22秒)
    └── src/components/C.tsx 作成

⏱️ 所要時間: 28秒（直列なら75秒、62%短縮）
```

### Step 5: 統合レポートの出力

Cursor（PM）に返却するための統合レポートを生成します。

---

## 統合レポート形式

```markdown
## 📊 並列タスク実行レポート

**実行日時**: 2025-12-12 10:30:00
**タスク数**: 3件（並列実行）
**所要時間**: 28秒

### 完了タスク

| # | タスク | ステータス | 所要時間 | 成果物 |
|---|-------|----------|---------|-------|
| 1 | A作成 | ✅ 成功 | 25秒 | src/components/A.tsx |
| 2 | B作成 | ✅ 成功 | 28秒 | src/components/B.tsx |
| 3 | C作成 | ✅ 成功 | 22秒 | src/components/C.tsx |

### 変更ファイル一覧

- `src/components/A.tsx` (新規)
- `src/components/B.tsx` (新規)
- `src/components/C.tsx` (新規)

### 次のアクション

- [ ] コードレビュー
- [ ] テスト実行
- [ ] マージ
```

---

## エラーハンドリング

### 一部タスク失敗時

```
📊 並列実行完了（一部エラー）

├── [Task 1] A作成 ✅ (25秒)
├── [Task 2] B作成 ❌ エラー
│   └── 原因: TypeScriptエラー
└── [Task 3] C作成 ✅ (22秒)

⚠️ 1件のタスクが失敗しました。
```

**対応**:
1. 成功したタスクの結果は保持
2. 失敗タスクのエラー詳細を表示
3. 再実行オプションを提示

### 全タスク失敗時

```
❌ 並列実行失敗

全てのタスクでエラーが発生しました。
詳細を確認し、個別に対応してください。
```

---

## 使用例

### 例1: コンポーネント並列作成

```
ユーザー: /parallel-tasks Header, Footer, Sidebar を作成

Claude Code:
📋 3つの独立タスクを検出しました。

並列実行計画:
1. Header → src/components/Header.tsx
2. Footer → src/components/Footer.tsx
3. Sidebar → src/components/Sidebar.tsx

実行しますか？ (y/n)

→ y

🚀 並列実行開始...
（実行中...）

📊 完了！3件のコンポーネントを作成しました。
所要時間: 35秒（直列なら1分45秒）
```

### 例2: 品質チェック並列実行

```
ユーザー: /parallel-tasks lint, test, type-check

Claude Code:
📋 3つのチェックコマンドを検出しました。

並列実行:
1. npm run lint
2. npm run test
3. npm run type-check

🚀 実行中...

📊 完了！
├── [Lint] ✅ 警告: 2件
├── [Test] ✅ 15/15 通過
└── [Type] ✅ エラーなし
```

---

## VibeCoder 向けガイド

| やりたいこと | コマンド例 |
|-------------|-----------|
| 複数ページ作成 | `/parallel-tasks ログイン、会員登録、プロフィールページを作成` |
| 複数コンポーネント | `/parallel-tasks ヘッダー、フッター、サイドバーを作成` |
| 品質チェック | `/parallel-tasks lint, test, build をチェック` |
| 複数ファイル分析 | `/parallel-tasks src/lib, src/components, src/app を分析` |

**ポイント**: カンマ区切りまたは「〜と〜」で複数タスクを指定できます。

---

## 注意事項

- 同一ファイルへの同時書き込みは避けてください
- 依存関係のあるタスクは自動的に直列実行されます
- タスク数が多すぎる場合（10件以上）は分割を推奨します
