# /update-2agent - 2ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆä½“åˆ¶ã®æ›´æ–°

æ—¢å­˜ã®2ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆä½“åˆ¶ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«æ›´æ–°ã—ã¾ã™ã€‚
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¿ã‚¹ã‚¯ã‚„è¨­å®šã‚’ä¿æŒã—ãªãŒã‚‰ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®æ”¹å–„ã‚’é©ç”¨ã—ã¾ã™ã€‚

---

## âš ï¸ å®Ÿè¡Œæ‰‹é †ï¼ˆå¿…é ˆï¼‰

**ã“ã®ã‚³ãƒžãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹éš›ã€ä»¥ä¸‹ã®æ‰‹é †ã‚’å¿…ãšå®Ÿè¡Œã™ã‚‹ã“ã¨ï¼š**

### Step 1: ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ

```bash
~/.claude/plugins/marketplaces/cursor-cc-marketplace/scripts/update-2agent.sh
```

### Step 2: æ¤œè¨¼ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã‚’ç¢ºèª

ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒæ›´æ–°ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆè‡ªå‹•æ¤œè¨¼ï¼‰ï¼š

- [ ] `.cursor/commands`
- [ ] `.cursor/commands/start-session.md`
- [ ] `.cursor/commands/assign-to-cc.md`
- [ ] `.cursor/commands/review-cc-work.md`
- [ ] `.cursor/commands/plan-with-cc.md`
- [ ] `.cursor/commands/project-overview.md`
- [ ] `.claude/rules`
- [ ] `.claude/rules/workflow.md`
- [ ] `.claude/rules/coding-standards.md`
- [ ] `.cursor-cc-version`

**å…¨ã¦ã®ãƒã‚§ãƒƒã‚¯ãŒé€šã‚‹ã¾ã§å®Œäº†ã¨ã¿ãªã•ãªã„ã“ã¨ã€‚**

---

## `/setup-2agent` ã¨ã®é•ã„

| ã‚³ãƒžãƒ³ãƒ‰ | ç”¨é€” | æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ« |
|---------|------|-------------|
| `/setup-2agent` | åˆå›žã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— | æ–°è¦ä½œæˆ |
| **`/update-2agent`** | æ—¢å­˜ç’°å¢ƒã®æ›´æ–° | **ãƒžãƒ¼ã‚¸æ›´æ–°** |

---

## ä½¿ã„æ–¹

```
/update-2agent
```

ã¾ãŸã¯è‡ªç„¶è¨€èªžã§ï¼š
- ã€Œ2ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆä½“åˆ¶ã‚’æ›´æ–°ã—ã¦ã€
- ã€Œãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ã¦ã€

---

## æ›´æ–°ã•ã‚Œã‚‹å†…å®¹

### æ§‹é€ çš„ãªæ›´æ–°ï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰é©ç”¨ï¼‰

- AGENTS.md ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³æ§‹é€ ãƒ»ãƒžãƒ¼ã‚«ãƒ¼å®šç¾©
- CLAUDE.md ã®ãƒ«ãƒ¼ãƒ«ãƒ»ç¦æ­¢äº‹é …
- .cursor/commands/ ã®ã‚³ãƒžãƒ³ãƒ‰å®šç¾©
- .claude/memory/ ã®æ§‹é€ 
- .claude/rules/ ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ«ãƒ¼ãƒ«ï¼ˆv0.4.0+ï¼‰

### ä¿æŒã•ã‚Œã‚‹å†…å®¹ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼‰

- Plans.md ã®ã‚¿ã‚¹ã‚¯ä¸€è¦§ï¼ˆ`cc:WIP`, `cc:TODO` ãªã©ï¼‰
- .claude/memory/ ã®è¨˜éŒ²å†…å®¹
- .claude/rules/ ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆãƒ«ãƒ¼ãƒ«ï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ãªã„ã‚‚ã®ï¼‰
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ã®ã‚«ã‚¹ã‚¿ãƒžã‚¤ã‚º

---

## å®Ÿè¡Œãƒ•ãƒ­ãƒ¼

### Phase 1: æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¤œå‡ºï¼ˆCase-Insensitiveï¼‰

**é‡è¦**: ãƒ•ã‚¡ã‚¤ãƒ«åã®å¤§æ–‡å­—å°æ–‡å­—ã®é•ã„ã‚’å¸åŽã™ã‚‹

```bash
# Case-insensitive ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œç´¢
find . -maxdepth 1 -iname "agents.md" -type f 2>/dev/null | head -1
find . -maxdepth 1 -iname "claude.md" -type f 2>/dev/null | head -1
find . -maxdepth 1 -iname "plans.md" -type f 2>/dev/null | head -1
```

æ¤œå‡ºãƒ‘ã‚¿ãƒ¼ãƒ³:
- `AGENTS.md`, `agents.md`, `Agents.md` â†’ ã™ã¹ã¦åŒä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦æ‰±ã†
- `PLANS.md`, `plans.md`, `Plans.md` â†’ ã™ã¹ã¦åŒä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦æ‰±ã†
- `CLAUDE.md`, `claude.md`, `Claude.md` â†’ ã™ã¹ã¦åŒä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦æ‰±ã†

### Phase 2: ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ¯”è¼ƒ

```bash
# ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³
PLUGIN_VERSION=$(cat ~/.claude/plugins/marketplaces/cursor-cc-marketplace/VERSION)

# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ãƒãƒ¼ã‚¸ãƒ§ãƒ³
INSTALLED_VERSION=$(grep "version:" .cursor-cc-version 2>/dev/null | cut -d' ' -f2)

echo "ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿: v${INSTALLED_VERSION:-ãªã—}"
echo "æœ€æ–°: v${PLUGIN_VERSION}"
```

### Phase 3: Plans.md ã®ãƒžãƒ¼ã‚¸æ›´æ–°

**é‡è¦**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¿ã‚¹ã‚¯ã‚’ä¿æŒã—ãªãŒã‚‰æ§‹é€ ã‚’æ›´æ–°

```markdown
# ä¿æŒã™ã‚‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼‰
## ðŸ”´ é€²è¡Œä¸­ã®ã‚¿ã‚¹ã‚¯
## ðŸŸ¡ æœªç€æ‰‹ã®ã‚¿ã‚¹ã‚¯
## ðŸŸ¢ å®Œäº†ã‚¿ã‚¹ã‚¯
## ðŸ“¦ ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–

# æ›´æ–°ã™ã‚‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰ï¼‰
## ãƒžãƒ¼ã‚«ãƒ¼å‡¡ä¾‹
## æœ€çµ‚æ›´æ–°æƒ…å ±ï¼ˆæ—¥ä»˜ã®ã¿æ›´æ–°ï¼‰
```

**ãƒžãƒ¼ã‚¸æ‰‹é †**:

1. æ—¢å­˜ã® Plans.md ã‚’èª­ã¿è¾¼ã‚€
2. ã‚¿ã‚¹ã‚¯ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆðŸ”´ðŸŸ¡ðŸŸ¢ðŸ“¦ï¼‰ã®å†…å®¹ã‚’æŠ½å‡º
3. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®æ§‹é€ ã‚’é©ç”¨
4. æŠ½å‡ºã—ãŸã‚¿ã‚¹ã‚¯ã‚’å†é…ç½®
5. æœ€çµ‚æ›´æ–°æƒ…å ±ã‚’æ›´æ–°

### Phase 4: AGENTS.md / CLAUDE.md ã®æ›´æ–°

ã“ã‚Œã‚‰ã¯æ§‹é€ ãŒãƒ¡ã‚¤ãƒ³ãªã®ã§ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§ä¸Šæ›¸ãï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåç­‰ã¯ä¿æŒï¼‰

```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã‚’æŠ½å‡º
PROJECT_NAME=$(grep "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ" AGENTS.md | head -1 | sed 's/.*: //')

# ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’é©ç”¨ã—ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã‚’ç½®æ›
```

### Phase 5: Cursor ã‚³ãƒžãƒ³ãƒ‰ã®æ›´æ–°

```bash
# æœ€æ–°ç‰ˆã§ä¸Šæ›¸ã
cp ~/.claude/plugins/marketplaces/cursor-cc-marketplace/templates/cursor/commands/*.md .cursor/commands/
```

### Phase 5.5: Claude Rules ã®æ›´æ–°

**v0.4.0 ã§è¿½åŠ **: `.claude/rules/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ«ãƒ¼ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›´æ–°

```bash
# .claude/rules/ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å­˜åœ¨ç¢ºèª
if [ ! -d ".claude/rules" ]; then
  mkdir -p .claude/rules
fi

# ãƒ—ãƒ©ã‚°ã‚¤ãƒ³æä¾›ã®ãƒ«ãƒ¼ãƒ«ã‚’æ›´æ–°ï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰ï¼‰
RULES_DIR=~/.claude/plugins/marketplaces/cursor-cc-marketplace/templates/rules

for template in "$RULES_DIR"/*.template; do
  if [ -f "$template" ]; then
    # .template ã‚’é™¤ã„ãŸãƒ•ã‚¡ã‚¤ãƒ«å
    rule_name=$(basename "$template" .template)
    target=".claude/rules/$rule_name"

    # ã‚³ãƒ”ãƒ¼ï¼ˆæ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã¯ä¸Šæ›¸ãï¼‰
    cp "$template" "$target"
    echo "  âœ… $rule_name ã‚’æ›´æ–°"
  fi
done
```

**æ³¨æ„**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç‹¬è‡ªã«ä½œæˆã—ãŸãƒ«ãƒ¼ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«å­˜åœ¨ã—ãªã„ã‚‚ã®ï¼‰ã¯ä¿æŒã•ã‚Œã¾ã™ã€‚

### Phase 6: ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®æ›´æ–°

```bash
cat > .cursor-cc-version << EOF
# cursor-cc-plugins version tracking
version: ${PLUGIN_VERSION}
installed_at: $(date +%Y-%m-%d)
last_setup_command: update-2agent
updated_from: ${INSTALLED_VERSION}
EOF
```

---

## Case-Insensitive ãƒ•ã‚¡ã‚¤ãƒ«æ­£è¦åŒ–

æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã®åå‰ãŒæ¨™æº–ã¨ç•°ãªã‚‹å ´åˆã€æ­£è¦åŒ–ã™ã‚‹ã‹ç¢ºèªï¼š

```
æ¤œå‡º: plans.md
æŽ¨å¥¨: Plans.md

ãƒ•ã‚¡ã‚¤ãƒ«åã‚’æ­£è¦åŒ–ã—ã¾ã™ã‹ï¼Ÿ (y/n)
```

æ­£è¦åŒ–ã™ã‚‹å ´åˆ:
```bash
mv plans.md Plans.md
```

---

## å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

```
âœ… **2ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆä½“åˆ¶ã‚’æ›´æ–°ã—ã¾ã—ãŸï¼** (v{{OLD_VERSION}} â†’ v{{NEW_VERSION}})

ðŸ“ **æ›´æ–°å†…å®¹**:
- AGENTS.md: æ§‹é€ ã‚’æ›´æ–°
- CLAUDE.md: æ§‹é€ ã‚’æ›´æ–°
- Plans.md: ã‚¿ã‚¹ã‚¯ã‚’ä¿æŒã—ã¤ã¤æ§‹é€ ã‚’æ›´æ–°
- .cursor/commands/: æœ€æ–°ç‰ˆã«æ›´æ–°
- .claude/rules/: ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ«ãƒ¼ãƒ«ã‚’æ›´æ–°

ðŸ“‹ **ä¿æŒã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿**:
- é€²è¡Œä¸­ã‚¿ã‚¹ã‚¯: Xä»¶
- æœªç€æ‰‹ã‚¿ã‚¹ã‚¯: Yä»¶
- å®Œäº†ã‚¿ã‚¹ã‚¯: Zä»¶

ðŸ’¡ å¤‰æ›´å±¥æ­´ã¯ `.cursor-cc-version` ã§ç¢ºèªã§ãã¾ã™
```

---

## ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

| çŠ¶æ³ | å¯¾å¿œ |
|------|------|
| ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã•ã‚Œã¦ã„ãªã„ | `/setup-2agent` ã‚’æ¡ˆå†… |
| æ—¢ã«æœ€æ–°ç‰ˆ | ã‚¹ã‚­ãƒƒãƒ—ï¼ˆå¼·åˆ¶æ›´æ–°ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚ã‚Šï¼‰ |
| Plans.md ã®è§£æžå¤±æ•— | ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ä½œæˆã—ã¦ç¶šè¡Œ |

---

## ã‚ªãƒ—ã‚·ãƒ§ãƒ³

| ã‚ªãƒ—ã‚·ãƒ§ãƒ³ | èª¬æ˜Ž |
|-----------|------|
| `--force` | æœ€æ–°ç‰ˆã§ã‚‚å¼·åˆ¶æ›´æ–° |
| `--backup` | æ›´æ–°å‰ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ä½œæˆ |
| `--dry-run` | å®Ÿéš›ã«ã¯æ›´æ–°ã›ãšã€å¤‰æ›´å†…å®¹ã‚’è¡¨ç¤º |

---

## é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«

| ãƒ•ã‚¡ã‚¤ãƒ« | å½¹å‰² |
|---------|------|
| `workflows/default/update-2agent.yaml` | ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®šç¾© |
| `skills/core/ccp-update-2agent-files/SKILL.md` | æ›´æ–°ã‚¹ã‚­ãƒ« |
| `skills/core/ccp-merge-plans/SKILL.md` | Plans.md ãƒžãƒ¼ã‚¸ã‚¹ã‚­ãƒ« |
