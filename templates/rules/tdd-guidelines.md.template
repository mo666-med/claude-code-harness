# TDD ガイドライン

> このルールは Claude harness によって自動生成されました。
> 目的: 適切な場面で TDD（テスト駆動開発）を提案し、品質向上を支援します。

## TDD とは

**Test-Driven Development（テスト駆動開発）**:
1. **Red**: 失敗するテストを先に書く
2. **Green**: テストを通す最小限の実装
3. **Refactor**: コードを綺麗にする

## 適用基準

### TDD 推奨（テスト先行）

| 条件 | 理由 |
|------|------|
| Plans.md で `[feature]` タグ | 新機能は仕様をテストで明確化 |
| `src/core/`, `src/services/` 配下 | ビジネスロジックは品質重要 |
| API エンドポイント追加 | 契約（インターフェース）を先に定義 |
| 複雑なアルゴリズム | エッジケースを先に洗い出し |

### 再現テスト先行

| 条件 | 理由 |
|------|------|
| Plans.md で `[bugfix]` タグ | バグを再現するテストで修正を検証 |
| 「動かない」系の報告 | 問題の本質を特定 |

### TDD 不要

| 条件 | 理由 |
|------|------|
| `[config]`, `[docs]` タグ | 設定やドキュメントはテスト対象外 |
| UI のスタイル調整 | ビジュアルはテストしにくい |
| 設定ファイル変更 | 検証が不要 |
| 既存テストがカバー済み | 重複回避 |

## ワークフロー

### エンジニア向け

```
1. テストファイルを作成
   - 期待する動作を describe/it で記述
   - まだ実装がないので失敗する（Red）

2. 最小実装
   - テストを通すだけのコード（Green）
   - 完璧を目指さない

3. リファクタリング
   - テストが通る状態を維持しながら改善
   - 命名、構造、パフォーマンス
```

### VibeCoder 向け（言い換え）

| TDD 用語 | VibeCoder 向け |
|---------|---------------|
| テストを先に書く | 成功基準を先に決める |
| Red（失敗するテスト） | 「こうなったら OK」リストを作る |
| Green（テストを通す） | 最小限動くようにする |
| Refactor（リファクタ） | コードを綺麗にする |

### 提案テンプレート

**エンジニア向け**:
> この機能追加は TDD で進めることを推奨します。
> テストファイルから作成しますか？

**VibeCoder 向け**:
> まず「何ができたら成功か」を決めましょう。
> チェックリストを作成しますか？

## 判定ロジック（スキル用）

```
タスク受領
    ↓
タグ確認: [feature] / [bugfix] / [config] / [docs]
    ↓
ファイルパス確認: src/core/, src/services/, src/api/
    ↓
├── [feature] + ビジネスロジック → TDD 推奨
├── [bugfix] → 再現テスト先行
├── [config] / [docs] → TDD 不要
└── UI スタイルのみ → TDD 不要
```

## 注意事項

- **強制ではなく提案**: ユーザーが判断
- **既存テストを尊重**: 重複作成しない
- **テストフレームワーク未検出時**: TDD 提案をスキップ
