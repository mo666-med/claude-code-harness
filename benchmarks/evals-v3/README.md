# 評価システム v3 - 曖昧プロンプト比較設計

## 背景：v1/v2 の問題点

### v1 の問題
```
with-plugin:  最適化されたプロンプト
no-plugin:    素朴なプロンプト
              ↓
         不公平な比較
```

### v2 の問題
```
with-plugin:  最適化されたプロンプト（CI専用コマンド）
no-plugin:    同じく最適化されたプロンプト（手動で再現）
              ↓
         結果が同じ（プラグインの価値を測定していない）
```

## v3 の設計：正しい比較

```
with-plugin:  曖昧なプロンプト + /plan-with-agent
no-plugin:    同じ曖昧なプロンプトのみ
              ↓
         プラグインが曖昧な指示を構造化する価値を測定
```

## 仮説

> ハーネスのコマンド（/plan-with-agent, /work, /harness-review）は、
> 曖昧な指示を構造化されたワークフローに変換し、
> 非エンジニアでもエンジニア品質のアウトプットを得られるようにする

## タスク設計

### 曖昧なプロンプト例

| ID | 曖昧なプロンプト（VibeCoder風） | 期待される差 |
|----|--------------------------------|-------------|
| VP-01 | 「ユーザー管理機能追加して」 | 計画の有無、要件確認 |
| VP-02 | 「ログイン画面作って」 | セキュリティ考慮の有無 |
| VP-03 | 「このバグ直して」 | テスト作成の有無 |
| VP-04 | 「コード整理して」 | レビュー実行の有無 |
| VP-05 | 「API作って」 | 設計・ドキュメントの有無 |

### 比較方法

```
Trial N:
  1. テストプロジェクトをクリーンセットアップ
  2. with-plugin: /plan-with-agent {曖昧なプロンプト}
  3. テストプロジェクトをリセット
  4. no-plugin: {同じ曖昧なプロンプト}
  5. 両方の結果を比較
```

## 測定メトリクス

| メトリクス | 説明 | with-plugin で期待 |
|-----------|------|-------------------|
| plans_created | Plans.md が作成されたか | 高い |
| requirements_clarified | 要件確認が行われたか | 高い |
| tests_created | テストが作成されたか | 高い |
| review_executed | レビューが実行されたか | 高い |
| security_considered | セキュリティが考慮されたか | 高い |
| code_quality | コード品質スコア | 高い |

## グレーダー

### Code-based
- Plans.md の存在と内容
- テストファイルの作成
- レビュー実行の証跡
- セキュリティ関連コードの存在

### Model-based
- 計画の網羅性
- 実装の品質
- 要件との整合性

## 使用方法

```bash
# 曖昧プロンプト比較を実行
./scripts/run-vague-comparison.sh --task VP-01 --iterations 5

# 全タスクを実行
./scripts/run-vague-comparison.sh --all --iterations 3
```

## 期待される結果

```
with-plugin:
  - 計画が強制される
  - 要件が明確化される
  - テストが作成される
  - レビューが実行される

no-plugin:
  - 計画なしで実装開始の可能性
  - 要件が曖昧なまま
  - テストが省略される可能性
  - レビューがスキップされる可能性
```

これにより「プラグインが曖昧な指示を構造化する価値」を定量的に測定できる。
