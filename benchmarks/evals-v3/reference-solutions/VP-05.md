# Reference Solution: VP-05 (API作成の曖昧な依頼)

## 元のプロンプト

「なんかデータを画面に表示するやつ作って。サーバー側の処理？よくわからないけど。あとから機能追加しやすくて、でもシンプルなのがいい」

## 曖昧さの問題点

1. **技術理解の欠如**: 「サーバー側の処理」が何か理解していない
2. **矛盾する要件**: 「シンプル」と「機能追加しやすい」はトレードオフの関係
3. **データ定義の欠如**: 何のデータを返すか不明
4. **技術スタック不明**: フレームワーク、言語の指定なし

## 参照解（理想的な Plans.md）

```markdown
# Plans.md - データ表示機能 実装計画

## 要件確認（ユーザーへのヒアリング結果）

### 確認事項

| 項目 | ユーザーへの質問 | 回答・決定 |
|------|-----------------|-----------|
| 表示するデータ | 「どんなデータを画面に出したい？」 | ユーザー情報（名前、メール等） |
| データの保存 | 「データはどこかに保存したい？」 | とりあえず動けばOK → メモリ保存（後でDB化可能） |
| ログイン | 「誰でも見れていい？」 | 後で制限したい → 認証機能を設計に含める |

### 「シンプル」と「機能追加しやすい」の両立方針

- **シンプル**: 最小限の構成で動くものを先に作る
- **機能追加しやすい**: ファイルを分けて整理し、後から機能を足しやすくする

---

## フェーズ1: 基盤構築 `cc:TODO`

- [ ] ディレクトリ構造の作成
- [ ] TypeScript 設定
- [ ] 型定義ファイルの作成

### ディレクトリ構造

```
src/
├── types/       # 型定義
├── services/    # ビジネスロジック
├── routes/      # API エンドポイント
└── server.ts    # エントリーポイント
```

---

## フェーズ2: ビジネスロジック `cc:TODO` `[feature:tdd]`

### テストケース設計

| テストケース | 入力 | 期待出力 | 備考 |
|-------------|------|---------|------|
| ユーザー作成（正常） | `{name, email}` | 201 + User | ID自動生成 |
| ユーザー作成（バリデーション） | `{name: ""}` | 400 | 空文字拒否 |
| ユーザー取得（存在） | 有効ID | 200 + User | - |
| ユーザー取得（不在） | 無効ID | 404 | - |
| 全ユーザー取得 | - | 200 + User[] | 空配列も可 |
| ユーザー更新 | `{id, name}` | 200 + User | updatedAt更新 |
| ユーザー削除 | 有効ID | 204 | - |

### 実装タスク

- [ ] テストファイル作成
- [ ] UserManager サービス実装
- [ ] テスト実行・確認

---

## フェーズ3: API エンドポイント `cc:TODO` `[feature:security]`

### エンドポイント設計

| メソッド | パス | 説明 | 認証 |
|---------|------|------|------|
| GET | `/api/users` | 全ユーザー取得 | 必要 |
| GET | `/api/users/:id` | ユーザー取得 | 必要 |
| POST | `/api/users` | ユーザー作成 | 必要 |
| PUT | `/api/users/:id` | ユーザー更新 | 必要 |
| DELETE | `/api/users/:id` | ユーザー削除 | 必要 |

### セキュリティ考慮事項

- [ ] 入力バリデーション（Zod または手動）
- [ ] エラーハンドリング（情報漏洩防止）
- [ ] CORS 設定

---

## フェーズ4: 統合・検証 `cc:TODO`

- [ ] Express サーバー作成
- [ ] ミドルウェア設定（JSON, CORS）
- [ ] ビルド確認
- [ ] 手動テスト（curl / HTTPie）
```

## 評価ポイント

### 必須要素（スコア高）

1. ✅ フェーズ分けされた構造化された計画
2. ✅ テストケース表の存在
3. ✅ エンドポイント設計表の存在
4. ✅ `[feature:tdd]` マーカー
5. ✅ `[feature:security]` マーカー
6. ✅ 要件確認セクション（曖昧さの解消）

### 加点要素

- 「シンプル vs 拡張性」のトレードオフ解決
- ディレクトリ構造の提案
- セキュリティ考慮事項の明記

### 減点要素

- フェーズなしの平坦なリスト
- テストケース表なし
- セキュリティへの言及なし
- 曖昧さを無視して実装開始
